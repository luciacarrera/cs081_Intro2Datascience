knitr::opts_chunk$set(echo = TRUE)
# Use the same data as in question 1 (a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.)    Using methods from class, find a 95% bootstrap confidence interval for the true percentage of students.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).  Also have R do a histogram of the bootstrap percentages.
# Point Estimate
PE <- 115/200 *100
PE
#  Generate trials using the PE for the probability
Trials <- rbinom(n = 10000000, size = 14, prob = PE/100)
#  Express the trials as percentages;
Perc <- 100 * Trials/14
#  Do  hist()
hist(Perc)
# pvalue
pValue <- 28 + 52 + 43 +  47  +50 + 57+  60
pValue
# In the text before this chunk, state the point estimate, and write a sentence of interpretation above (I’m 95% sure…..)  Based on your interval, do you believe that a majority of all UVM students would say they are better or way better than average drivers?   How do you know?   How sure are you of the conclusion about a majority? (write answers above)
# pvalue
# pvalue
pValue <- 28 + 52 + 43 +  47  +50 + 57+  60
pValue
# pvalue
pValue <- 28 + 52 + 43 +  47  +50 + 57+  60 /1000
pValue
# pvalue
pValue <- 28 + 52 + 43 +  47  +50 + 57 /1000
pValue
# Use the same data as in question 1 (a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.)    Using methods from class, find a 95% bootstrap confidence interval for the true percentage of students.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).  Also have R do a histogram of the bootstrap percentages.
# Point Estimate
PE <- 115/200 *100
PE
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 10000000, size = 14, prob = PE/100)
#  Express the trials as percentages;
Perc <- 100 * Trials2/14
#  Do  hist()
hist(Trials2)
tables (Trials2)
table(Trials2)
# Use the same data as in question 1 (a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.)    Using methods from class, find a 95% bootstrap confidence interval for the true percentage of students.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).  Also have R do a histogram of the bootstrap percentages.
# Point Estimate
PE <- 115/200 *100
PE
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 10000000, size = 14, prob = PE/100)
#  Express the trials as percentages;
Perc <- 100 * Trials2/14
#  Do  hist()
hist(Trials2)
table(Trials2)
# Standard Error
SE <- sd(Trials)
# Margin of error
ME <- 2*SE
lowerlimit <- PE - ME
upperlimit <- PE + ME
lowerlimit <- round(lowerlimit,3)
upperlimit <- round(upperlimit,3)
# In the text before this chunk, state the point estimate, and write a sentence of interpretation above (I’m 95% sure…..)  Based on your interval, do you believe that a majority of all UVM students would say they are better or way better than average drivers?   How do you know?   How sure are you of the conclusion about a majority? (write answers above)
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 10000000, size = 14, prob = 115/200)
# Use the same data as in question 1 (a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.)    Using methods from class, find a 95% bootstrap confidence interval for the true percentage of students.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).  Also have R do a histogram of the bootstrap percentages.
# Point Estimate
PE <- 115/200 *100
PE
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 10000000, size = 14, prob = 115/200)
#  Express the trials as percentages;
Perc <- 100 * Trials2/14
#  Do  hist()
hist(Trials2)
table(Trials2)
# Standard Error
SE <- sd(Trials2)
# Margin of error
ME <- 2*SE
lowerlimit <- PE - ME
upperlimit <- PE + ME
lowerlimit <- round(lowerlimit,3)
upperlimit <- round(upperlimit,3)
# In the text before this chunk, state the point estimate, and write a sentence of interpretation above (I’m 95% sure…..)  Based on your interval, do you believe that a majority of all UVM students would say they are better or way better than average drivers?   How do you know?   How sure are you of the conclusion about a majority? (write answers above)
# Use the same data as in question 1 (a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.)    Using methods from class, find a 95% bootstrap confidence interval for the true percentage of students.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).  Also have R do a histogram of the bootstrap percentages.
# Point Estimate
PE <- 115/200 *100
PE
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 10000000, size = 200, prob = 115/200)
#  Express the trials as percentages;
Perc <- 100 * Trials2/14
#  Do  hist()
hist(Trials2)
table(Trials2)
# Standard Error
SE <- sd(Trials2)
# Margin of error
ME <- 2*SE
lowerlimit <- PE - ME
upperlimit <- PE + ME
lowerlimit <- round(lowerlimit,3)
upperlimit <- round(upperlimit,3)
# In the text before this chunk, state the point estimate, and write a sentence of interpretation above (I’m 95% sure…..)  Based on your interval, do you believe that a majority of all UVM students would say they are better or way better than average drivers?   How do you know?   How sure are you of the conclusion about a majority? (write answers above)
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 1000, size = 200, prob = 115/200)
# Use the same data as in question 1 (a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.)    Using methods from class, find a 95% bootstrap confidence interval for the true percentage of students.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).  Also have R do a histogram of the bootstrap percentages.
# Point Estimate
PE <- 115/200 *100
PE
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 1000, size = 200, prob = 115/200)
#  Express the trials as percentages;
Perc <- 100 * Trials2/14
#  Do  hist()
hist(Trials2)
table(Trials2)
# Standard Error
SE <- sd(Trials2)
# Margin of error
ME <- 2*SE
lowerlimit <- PE - ME
upperlimit <- PE + ME
lowerlimit <- round(lowerlimit,3)
upperlimit <- round(upperlimit,3)
# In the text before this chunk, state the point estimate, and write a sentence of interpretation above (I’m 95% sure…..)  Based on your interval, do you believe that a majority of all UVM students would say they are better or way better than average drivers?   How do you know?   How sure are you of the conclusion about a majority? (write answers above)
print(paste("I am 95% confident the true mean difference of students saying they are better drivers is captured in the interval from",lowerlimit, upperlimit))
# Once you have your code working for problem 3a, change it so that you can find the bootstrap confidence interval for the true mean response to the question ‘Circle where you political leaning falls, where 0 is most LIBERAL and 10 is most CONSERVATIVE.’ Produce the same output, described above. (Include the same output, including the histogram of the bootstrap means.)
os <- na.omit(s$Political)
PE <- mean(os)
os <- na.omit(s$Political)
# Use the attached data file surveyC_S21.csv, download it, and read in as a data frame called, s.  Assume the data is a random sample of 200 UVM students.  Using the bootstrap method, and code similar to the code from class, find a 95% confidence interval for the true mean earnings for UVM students.  Have R do a histogram of the bootstrap means, calculate the standard deviation of the bootstrap means (the SE), calculate the margin of error, and Upper and Lower limits of the confidence interval.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).
# data loading
s <- read.csv("surveyC_F21.csv")
library(tidyverse)
os <- na.omit(s$Earnings)
# point estimate
PE <- mean(os)
PE
# for loop for boostrap confidence
Allmeans <- c()
for (i in 1:1000){
mySample <- mean(sample(os, size = length(os), replace = TRUE))
Allmeans[i] <- mean(mySample)
}
# histogram
hist(Allmeans)
# Standard Error
SE <- sd(Allmeans)
# Margin of error
ME <- 2*SE
# upper and lower limit
lowerlimit <- PE - ME
upperlimit <- PE + ME
lowerlimit <- round(lowerlimit,2)
upperlimit <- round(upperlimit,2)
# printing of limits
lowerlimit
upperlimit
#  Above this code chunk, state the point estimate, then state the interval in a complete sentence in terms of the problem, as we’ve done in class.  (I’m 95% sure…..)   (Hint:   Remember that you need to specify that Earnings is in the data frame, s:   os <- s$Earnings and you may need to remove missing values)
# Once you have your code working for problem 3a, change it so that you can find the bootstrap confidence interval for the true mean response to the question ‘Circle where you political leaning falls, where 0 is most LIBERAL and 10 is most CONSERVATIVE.’ Produce the same output, described above. (Include the same output, including the histogram of the bootstrap means.)
os <- na.omit(s$Political)
PE <- mean(os)
PE
# for loop for bootstrap
Allmeans <- c()
for (i in 1:1000){
samp <- mean(sample(os, size = length(os), replace = TRUE))
Allmeans[i] <- mean(samp)
}
# histogram
hist(Allmeans)
# Standard Error
SE <- sd(Allmeans)
# Margin of error
ME <- 2*SE
lowerlimit <- PE - ME
upperlimit <- PE + ME
lowerlimit <- round(lowerlimit,3)
upperlimit <- round(upperlimit,3)
#upper and lowerlimit
lowerlimit
upperlimit
#  Above this code chunk, state the point estimate, and state the interval in a complete sentence in terms of the problem, as we’ve done in class.  (I’m 95% sure…..)   If a value of 5 is ‘average’ or ‘centrist,” does your confidence interval allow you to say that UVM students consider themselves to be more liberal than average?  Explain..
table(Trials)
# Suppose you surveyed a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.    Do a hypothesis test to see if the true proportion of UVM students who would say they are better or way better drivers is a majority.   That is, use the null hypothesis “50% of students would say they are better or way better than average”.   Generate 1000 trials, compute the ‘p-value’ and state your decision (above), in terms of the problem.
# Observer Result (OR)
OR <- 115/200
# Null Hypothesis: 50% of students would say they are better or way better than average
Trials <- rbinom(n = 1000, size = 200, prob = .5)
hist(Trials)
table(Trials)
# pvalue
pValue <- 28 + 52 + 43 +  47  +50 + 57 /1000
pValue
print(paste("I am 95% confident the true mean difference of students saying they are better drivers is captured in the interval from",lowerlimit, upperlimit))
# Use the same data as in question 1 (a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.)    Using methods from class, find a 95% bootstrap confidence interval for the true percentage of students.  Have R calculate and print the lower and upper limit, rounding each value to 2 decimal places. (xx.xx  to xx.xx).  Also have R do a histogram of the bootstrap percentages.
# Point Estimate
PE <- 115/200 *100
PE
#  Generate trials using the PE for the probability
Trials2 <- rbinom(n = 1000, size = 200, prob = 115/200)
#  Express the trials as percentages;
Perc <- 100 * Trials2/14
#  histogram and table
hist(Trials2)
table(Trials2)
# Standard Error
SE <- sd(Trials2)
# Margin of error
ME <- 2*SE
# upper and lower limit
lowerlimit <- PE - ME
upperlimit <- PE + ME
lowerlimit <- round(lowerlimit,3)
upperlimit <- round(upperlimit,3)
# In the text before this chunk, state the point estimate, and write a sentence of interpretation above (I’m 95% sure…..)  Based on your interval, do you believe that a majority of all UVM students would say they are better or way better than average drivers?   How do you know?   How sure are you of the conclusion about a majority? (write answers above)
print(paste("I am 95% confident the true mean difference of students saying they are better drivers is captured in the interval from",lowerlimit, upperlimit))
# Suppose you surveyed a random sample of 200 UVM students, and 115 of them said they are ‘Better than Average’ or “Way Better than Average” drivers.    Do a hypothesis test to see if the true proportion of UVM students who would say they are better or way better drivers is a majority.   That is, use the null hypothesis “50% of students would say they are better or way better than average”.   Generate 1000 trials, compute the ‘p-value’ and state your decision (above), in terms of the problem.
# Observer Result (OR)
OR <- 115/200
# Null Hypothesis: 50% of students would say they are better or way better than average
Trials <- rbinom(n = 1000, size = 200, prob = .5)
hist(Trials)
table(Trials)
# pvalue
pValue <- 28 + 52 + 43 +  47  +50 + 57 /1000
pValue
